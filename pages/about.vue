<template>
  <div class="article-template">
    <NuxtLink to="/" class="button button-back" title="Back">
      <div class="button-box">
				<span class="button-elem">
					<svg viewBox="0 0 46 40" id="fleche" xmlns="http://www.w3.org/2000/svg">
						<path
                d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"></path>
					</svg>
				</span>
        <span class="button-elem">
          <svg viewBox="0 0 46 40"><use xlink:href="#fleche"></use></svg>
        </span>
      </div>
    </NuxtLink>
    <section class="header">
      <picture>
        <source media="screen and (min-width: 992px)" srcset="/seven-wonders/chichen-itza.jpg">
        <img src="/seven-wonders/small-1000/chichen-itza(1000).jpg" class="header-img" alt="">
      </picture>
      <h1 class="header-h1">Statue of<br>Christ the Redeemer</h1>
    </section>

    <section class="article">
      <div class="article-text">

        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ab aspernatur, consequatur enim itaque modi nulla
          omnis quam quasi tempora. Ab facilis impedit in incidunt nisi. Autem cumque illum ipsam iusto libero molestiae
          molestias nam natus nesciunt optio quis quisquam sint, vitae. Non nulla saepe totam. Accusamus architecto
          atque consequatur, dignissimos id, in iusto maiores molestias perferendis praesentium quis quos rem
          repudiandae sint sit ut voluptas. Consequatur consequuntur cum dicta fugit maiores? Asperiores consectetur
          distinctio doloremque iusto maiores repellat repellendus reprehenderit unde! Accusantium consectetur
          consequuntur corporis cumque ea eos, est expedita fugiat in inventore itaque odio, quo quod, temporibus
          voluptatum? Architecto asperiores beatae deleniti, doloribus error explicabo fugit laboriosam modi neque
          optio.<img src="/seven-wonders/small-500/chichen-itza(500)-two.jpg" alt="" class="article-img" align="left"/>
          Ab aperiam at blanditiis, culpa doloremque error eum facere facilis inventore, odio quam quibusdam
          similique tempore? Animi aperiam blanditiis deserunt dignissimos distinctio doloribus eaque est, ex
          exercitationem expedita explicabo facere fugit incidunt iste laborum modi molestias nam neque nulla odio odit
          officia perferendis placeat provident quae quam quo reprehenderit rerum sapiente sequi sint ullam voluptas
          voluptate! Aliquid beatae commodi dolor laboriosam quam quo soluta tenetur voluptatem. A delectus dignissimos
          ea enim incidunt labore non veritatis! Doloribus et excepturi explicabo, labore magni neque quibusdam quo quos
          suscipit voluptatum? Ab adipisci at commodi consequatur doloremque expedita id, impedit necessitatibus
          nesciunt officiis, sed ut veniam voluptas voluptatem voluptates. Ab ad alias atque doloribus minus quaerat,
          quidem saepe sequi tempore ullam! Ab assumenda dignissimos fugiat iste ratione. Accusantium aut blanditiis
          consectetur cupiditate dignissimos distinctio dolore doloremque eaque exercitationem id ipsa ipsam libero
          minus, optio quasi, qui quisquam similique. A aliquam aliquid assumenda consectetur consequatur cupiditate
          dolorem doloribus est eum harum ipsam labore magni maiores molestias nam necessitatibus neque omnis placeat
          quibusdam quo, quos sed sint sit sunt, tempore vitae voluptates voluptatibus. Harum incidunt non officiis
          possimus quae quis veniam? Ab accusantium ad at beatae distinctio doloribus eaque eos fuga iusto libero maxime
          molestiae nam natus obcaecati officia pariatur porro quod, quos recusandae sint. Amet cupiditate dicta facilis
          fuga porro quas reprehenderit saepe sint tenetur, veniam? Beatae dicta enim esse magnam nesciunt nulla porro,
          quae quas quis, recusandae sit soluta sunt voluptatum! Ad ducimus excepturi ipsa ipsam ipsum iste minima minus
          modi nemo nesciunt, quidem repellendus temporibus voluptate. A alias aspernatur assumenda culpa cumque
          eligendi enim ipsum labore magnam magni molestias obcaecati provident quam quod, similique. Aperiam asperiores
          at consectetur dolor doloremque fugiat, fugit, illum in molestias nam natus obcaecati perspiciatis quaerat
          quibusdam quis repellat reprehenderit sapiente similique sint, sit tenetur ullam vitae voluptatem! Amet at
          atque consequuntur corporis cumque delectus dolor eum excepturi expedita explicabo harum inventore nemo nihil,
          possimus quibusdam rem sint tenetur vel, veritatis voluptates. Amet aspernatur eum fugit iusto laborum nisi,
          odit possimus praesentium velit. Aliquam atque consectetur nulla perferendis temporibus. Distinctio eaque
          eveniet excepturi illo natus nesciunt odit qui recusandae sint voluptate. Ab incidunt iste libero perferendis
          possimus quidem soluta, ut? At aut, cum deleniti dignissimos dolor expedita facere laboriosam laborum suscipit
          vero. Accusamus aliquam assumenda autem doloremque eius eligendi labore modi nostrum odio perferendis, quidem
          rem repellat repudiandae sapiente, similique, tempora temporibus ut. Debitis delectus ea excepturi illo
          incidunt inventore molestias mollitia nemo quaerat vero. Accusantium ad alias aliquam asperiores blanditiis
          culpa cupiditate dignissimos dolorem doloribus earum explicabo fugiat illo in incidunt iste iusto magnam magni
          molestias mollitia natus neque nulla officiis pariatur perspiciatis placeat provident quas quis quos rem rerum
          sapiente sequi sunt totam, ut, veritatis vitae voluptate. Culpa, dignissimos dolore modi repudiandae similique
          velit. Ab aperiam aspernatur assumenda at deleniti doloremque dolorum earum eligendi est id illum, iste
          labore, nihil officia optio, veniam voluptatem voluptates voluptatibus! Ab accusamus ad aliquam aspernatur
          assumenda, cum cupiditate debitis deserunt dicta dignissimos doloremque ea eligendi eos est eum fugiat
          inventore iste minima, molestias numquam obcaecati officiis omnis possimus praesentium quaerat quas, quidem
          quod ratione sequi sit tempora tempore totam vitae. Asperiores dicta ducimus enim et facere fuga ipsam iste
          magni minima molestias natus nobis non numquam, obcaecati praesentium quis repudiandae sed sint sit tempore
          unde vitae voluptate voluptatibus. Blanditiis deserunt dolores laudantium, natus provident quidem ratione
          repudiandae vel vitae voluptatum. Adipisci aliquam aperiam asperiores dolorem doloremque eius error est et
          facilis laboriosam, magnam nemo nulla odit, praesentium quasi qui quis, reprehenderit. Ad aut autem blanditiis
          consequuntur dolorum eaque, enim et excepturi harum hic itaque magni molestias natus nisi non odio quasi qui
          quidem quis reprehenderit sed sint soluta tempora tempore unde ut velit voluptas voluptate voluptatem
          voluptates? At cumque, doloremque earum eius, ipsum laborum libero molestias quibusdam reprehenderit sit
          soluta, temporibus ullam unde velit vero? Consectetur, eos illum impedit libero magnam non perferendis.
          Commodi doloribus officia quis recusandae vitae! Eum excepturi nulla tempore. Deserunt, facilis, id?
          Accusantium aliquid animi beatae blanditiis, corporis cum debitis deleniti esse fugiat illo incidunt
          laboriosam molestiae necessitatibus non quisquam reprehenderit rerum ullam unde voluptas voluptatibus.
          Deleniti earum inventore non optio perspiciatis quam qui sapiente soluta suscipit voluptate! At aut dolorem
          fugit ipsam, necessitatibus odit optio quae rerum totam voluptatem. Accusantium alias assumenda cupiditate
          dignissimos dolores dolorum eius, enim fuga in inventore itaque iusto laboriosam, magnam maxime quaerat quas
          quasi qui quia quo repudiandae saepe sapiente similique, sit tempore tenetur veritatis voluptas voluptatibus?
          Ab alias architecto deleniti dignissimos dolore doloribus eligendi et exercitationem expedita explicabo
          facilis fugiat laboriosam libero maxime molestiae natus nostrum omnis, praesentium ratione reprehenderit saepe
          sequi soluta tenetur velit vero. Minima omnis, voluptates? Ab, facere, ipsa! Asperiores aspernatur cum
          delectus dicta ducimus ea expedita maxime officia quas quia. Cum dolor, harum impedit libero maxime modi natus
          officia perspiciatis placeat possimus, quos recusandae rerum sed suscipit temporibus, velit voluptas.
          Aspernatur consectetur, dolorem ipsam molestias numquam sed sit voluptatem! Deleniti deserunt ex molestiae quo
          quos reiciendis sed tempore voluptas? Blanditiis doloribus ducimus eaque illo ipsa magnam mollitia, quis! A,
          adipisci at consequuntur, corporis delectus dicta earum enim eos esse fugiat illo in ipsam itaque molestiae
          molestias mollitia nesciunt odit perferendis quod reiciendis repellat sunt, veritatis vitae. Architecto
          asperiores eveniet, libero natus quaerat sed? Architecto autem cumque dolore dolorum nam odio quae quaerat
          reiciendis reprehenderit saepe, similique suscipit ullam, voluptatibus. Eius error odit possimus praesentium
          temporibus?</p>
      </div>
    </section>
  </div>
</template>

<script setup>
import {onMounted, ref, nextTick, watch, watchEffect, defineEmits} from "vue";
import {gsap} from "gsap";
import {useTransitionsStore} from '~/store/state';

definePageMeta({
  layout: "default",
  pageTransition: {
    mode: 'in-out',
    //name: 'pages'
    css: false,
    onBeforeEnter(el) {
      useTransitionsStore().articleFromEnter(el);
    },
    onEnter(el, done) {
      useTransitionsStore().articleEnter(el, done)
    },
    // onBeforeLeave(el) {
    //   useTransitionsStore().articleBeforeLeave(el);
    // },
    onLeave(el, done) {
      useTransitionsStore().articleLeave(el, done);
    }
  }
});

useHead({
  title: 'About '
})

//const route = useRoute().path;

const emit = defineEmits(['dataName', 'check']);
const active = ref('chichen-itza');
//const check = ref(false);
//const active = ref(route);
const store = useTransitionsStore();

watchEffect(() => {
  emit('dataName', active.value)
  //emit('check', check.value)
  //console.log('ypa',active.value)
})

onMounted(() => {
  //const button = document.querySelector('.button');

  //const header = document.querySelector('.header');
  const article = document.querySelector('.article');
  // const headerH1 = document.querySelector('.header-h1');
  // const headerImg = document.querySelector('.header-img');
  const root = document.documentElement;

  // const resizeObserver = new ResizeObserver(() => {
  //   let bodyWrapSize = bodyWrap.getBoundingClientRect().height;
  //   let wHeaderWrap = headerWrap.getBoundingClientRect();
  //   let result = (1080 - bodyWrapSize)/2 + wHeaderWrap.top; //поменять значение 1080
  //   root.style.setProperty('--result', `${-result}px`);
  //   // store.position.itemX = wHeaderWrap.x.toFixed(2);
  //   // store.position.itemY = wHeaderWrap.y.toFixed(2);
  //   // console.log(store.position,'result');
  // })
  // resizeObserver.observe(bodyWrap);

  gsap.set(root, {'--opacity-bg': 1});

  function moveArticle() {
    store.check = true;
    gsap.set(root, {
      '--top': '3vh', '--right': '3vw', '--bottom': '82dvh',
      '--left': '3vw', '--bottom-header-h1': '82dvh'
    });
    gsap.set(article, {className: 'article active-article'});
  }

  document.addEventListener('wheel', function (e) {
    if (e.deltaY === 100) moveArticle();
  });

  document.addEventListener("keydown", (e) => {
    if (e.code === 'ArrowDown') moveArticle();
  });

  let touchstartY = 0;
  let touchendY = 0;

  document.addEventListener('touchstart', e => {
    touchstartY = e.changedTouches[0];
  });

  document.addEventListener('touchend', e => {
    touchendY = e.changedTouches[0];
    let xAbs = Math.abs(touchstartY.pageY - touchendY.pageY);
    if (xAbs > 50) moveArticle();
  });

})

</script>

<style lang="sass" scoped>
.article-template
  position: relative
  inset: 0

.button-box
  display: flex
  position: absolute
  top: 0
  left: 0

.button-elem
  display: block
  width: 22px
  height: 22px
  margin: 18px 19px 20px
  transform: rotate(180deg)
  fill: var(--color-button-one)

.button-back
  position: fixed
  top: 10px
  left: 10px
  z-index: 1

  &:hover, &:focus
    > .button-box
      transition: .4s
      transform: translateX(-60px)

.header
  display: flex
  position: sticky
  top: 0
  width: 100%
  //height: 100%
  clip-path: inset(var(--top) var(--right) var(--bottom) var(--left) round 16px)
  //transition-timing-function: ease-in
  transition: 0.4s
  will-change: contents
//perspective: 1000px
//backface-visibility: hidden
//transform: translateZ(0)

.header-img
  height: 100%
  object-fit: cover

picture
  width: 100%
  height: 100dvh

.header-h1
  position: absolute
  bottom: var(--bottom-header-h1)
  left: calc(var(--left) + 20px)
  font: 6.5vmin 'Avantgardectt-bold'
  opacity: var(--opacity-header-h1)
  color: #F0EEEF
  text-shadow: 0 0 20px rgba(0, 0, 0, 1)
  transition: 0.4s

.article
  width: 100%
  height: 72dvh
  overflow-x: hidden
  scrollbar-width: thin
  //Fire Fox
  scrollbar-color: #31363B #232629
  //Fire Fox
  transform: translateY(0)
  transition: 0.6s
  opacity: 0

  &::-webkit-scrollbar
    width: 8px

.active-article
  transform: translateY(-78dvh)
  opacity: 1

.article::-webkit-scrollbar-track-piece
  background-color: #232629

.article::-webkit-scrollbar-thumb:vertical
  border-radius: 8px
  background-color: #31363B

.article-text
  max-width: 1200px
  padding: 0 16px
  margin: 0 auto
  color: #F0EEEF

.article-img
  max-width: 300px
  margin: 10px 10px 10px 0


@media only screen and (max-width: 760px)
  .header-h1
    font-size: 7vmin

@media only screen and (max-width: 480px)
  .header-h1
    margin: 0 0 16px


</style>
